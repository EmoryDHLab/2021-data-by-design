---
import type { ContentData } from 'google-docs-components';
import { Renderer as VueRenderer } from "docs-renderer-vue3"
export interface Props {
  content: ContentData,
  vueComponents: { [key: string]: any }
  astroComponents: { [key: string]: any }
  tableComponent?: Object | false,
  inlineSlotFormat?: RegExp,
  ignoreCSS?: string[],
}

const { content, astroComponents, vueComponents } = Astro.props;

const isString = typeof content == "string";
const isElement = content?.element;
const isComponent = content?.component;
const isVueComponent = vueComponents && vueComponents[isComponent];
const isAstroComponent = isComponent && !isVueComponent && astroComponents?.[isComponent];

if (isAstroComponent) {
  console.log("here!!!", content);
  console.log(content.slots)
}
const component = {
  astro: isAstroComponent
}

// if (isComponent) console.log(isComponent);
// if (content?.table) console.log(content.table);
if (!isString || !isElement) {
  // console.log(content)
}
 
const stringifyStyle = (style: object) => {
  return Object.keys(style).map(key => `${key}: ${style[key]};`).join(" ");
};

const keys = content.slots && Object.keys(content.slots);

if (keys) {
  console.log(keys);
}
---
{isAstroComponent && (<><component.astro {...content?.props}>
  {content?.slots?.default && <Astro.self content={content.slots.default} />}
</component.astro></>)}
{
  isVueComponent ? <VueRenderer content={[content]} components={vueComponents}/> : 
  isString ? content :
  isElement && <content.element style={stringifyStyle(content.style || {})}>{content.children && content.children.map(child => 
      <Astro.self content={child}/>)}</content.element>
}